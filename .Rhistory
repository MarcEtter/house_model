data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
ggplot(data = seats_ensemble, aes(seat_count)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
posterior_ensemble <- combined |>
select(state, district, year, r_d_victory_margin_baseline, matches('X', ignore.case = F)) |>
mutate(across(matches('X', ignore.case = F),
~ . * ENSEMBLE_WT_MRP + r_d_victory_margin_baseline * ENSEMBLE_WT_BASELINE))
seats_ensemble <- data.frame(seats_ensemble = apply(posterior_ensemble |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
seats_mrp <- data.frame(seats_mrp = apply(combined |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
theme_bw()
final_prediction <- read.csv('cleaned_data/ddhq_data.csv')
final_prediction
final_prediction |> names()
combined
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D/R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction
final_prediction$R.D.Victory.Margin
(final_prediction |> filter(year == 2018))$R.D.Victory.Margin
final_prediction |> filter(year == 2018)
View(final_prediction)
final_prediction |> filter(year = 2018)
final_prediction |> filter(year == 2018)
final_prediction <- read.csv('cleaned_data/ddhq_data.csv')
final_prediction |> filter(year == 2018)
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D/R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D/R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D/R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin = '???' ~ NA_character_,
.default = R.D.Victory.Margin
))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D/R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |> select(state, year, district, r_d_victory_margin_ensemble),
by = c('state', 'year', 'district'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district')),
by = c('State', 'Year', 'Congressional.District')) |>
mutate(R.D.Victory.Margin = coalesce(R.D.Victory.Margin, r_d_victory_margin_ensemble))
combined$r_d_victory_margin_ensemble
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district')),
by = c('State', 'Year', 'Congressional.District')) |>
mutate(R.D.Victory.Margin = coalesce(R.D.Victory.Margin, r_d_victory_margin_ensemble*100))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district')),
by = c('State', 'Year', 'Congressional.District'))
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble) |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district')),
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble) |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district'),
by = c('State', 'Year', 'Congressional.District')) |>
mutate(R.D.Victory.Margin = coalesce(R.D.Victory.Margin, r_d_victory_margin_ensemble*100))
write.csv(final_prediction, 'FINAL_PREDICTION.csv')
final_prediction <- read.csv('cleaned_data/ddhq_data.csv') |>
mutate(R.D.Victory.Margin = case_when(
R.D.Victory.Margin == '???' ~ NA_character_,
.default = R.D.Victory.Margin
)) |>
mutate(R.D.Victory.Margin = as.double(R.D.Victory.Margin)) |>
left_join(combined |>
select(state, year, district, r_d_victory_margin_ensemble) |>
rename('State' = 'state',
'Year' = 'year',
'Congressional.District' = 'district'),
by = c('State', 'Year', 'Congressional.District')) |>
mutate(R.D.Victory.Margin = coalesce(R.D.Victory.Margin, r_d_victory_margin_ensemble*100))
write.csv(final_prediction, 'cleaned_data/FINAL_PREDICTION.csv')
posterior_ensemble <- combined |>
select(state, district, year, r_d_victory_margin_baseline, matches('X', ignore.case = F)) |>
mutate(across(matches('X', ignore.case = F),
~ . * ENSEMBLE_WT_MRP + r_d_victory_margin_baseline * ENSEMBLE_WT_BASELINE))
seats_ensemble <- data.frame(seats_ensemble = apply(posterior_ensemble |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
seats_mrp <- data.frame(seats_mrp = apply(combined |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
theme_bw()
plt_mrp <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
theme_bw()
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(plt_ensemble | plt_mrp, outfile, height = 7, width = 7)
library(patchwork)
posterior_ensemble <- combined |>
select(state, district, year, r_d_victory_margin_baseline, matches('X', ignore.case = F)) |>
mutate(across(matches('X', ignore.case = F),
~ . * ENSEMBLE_WT_MRP + r_d_victory_margin_baseline * ENSEMBLE_WT_BASELINE))
seats_ensemble <- data.frame(seats_ensemble = apply(posterior_ensemble |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
seats_mrp <- data.frame(seats_mrp = apply(combined |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
theme_bw()
plt_mrp <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = '', y = '', title = '')
theme_bw()
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(plt_ensemble | plt_mrp, outfile, height = 7, width = 7)
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile,plt_ensemble | plt_mrp, height = 7, width = 7)
posterior_ensemble <- combined |>
select(state, district, year, r_d_victory_margin_baseline, matches('X', ignore.case = F)) |>
mutate(across(matches('X', ignore.case = F),
~ . * ENSEMBLE_WT_MRP + r_d_victory_margin_baseline * ENSEMBLE_WT_BASELINE))
seats_ensemble <- data.frame(seats_ensemble = apply(posterior_ensemble |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
seats_mrp <- data.frame(seats_mrp = apply(combined |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(binwidth = 1) +
labs(x = 'Project GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats (1000 Draws)')
theme_bw()
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(binwidth = 1) +
labs(x = 'Project GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats (1000 Draws)')
theme_bw()
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7, width = 7)
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black",
alpha = 0.8)
labs(x = 'Project GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Project GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7, width = 7)
?theme()
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black",
alpha = 0.8) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7, width = 7)
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
axis.ticks.length.x = 3)
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
axis.ticks.length.x = 1)
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
axis.ticks.x = 3)
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
axis.ticks.x = 1)
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
scale_x_continuous(breaks = seq(min(seats_mrp$seats_mrp), max(seats_mrp$seats_mrp), by = 3)))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
scale_x_continuous(breaks = seq(min(seats_ensemble$seats_ensemble), max(seats_ensemble$seats_ensemble), by = 1)))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
scale_x_continuous(labels =c(140,150,160,170)))
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
scale_x_continuous(labels =c(188, 191, 194, 197, 200)))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(140,150,160,170),
breaks =c(140,150,160,170) )
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(188, 191, 194, 197, 200),
breaks  =c(188, 191, 194, 197, 200))
###Save to file
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(140,150,160,170),
breaks =c(140,150,160,170) )
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats', y = 'Frequency', title = 'Project GOP House Seats\n (1000 Draws)') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(188, 191, 194, 197, 200),
breaks  =c(188, 191, 194, 197, 200))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
posterior_ensemble <- combined |>
select(state, district, year, r_d_victory_margin_baseline, matches('X', ignore.case = F)) |>
mutate(across(matches('X', ignore.case = F),
~ . * ENSEMBLE_WT_MRP + r_d_victory_margin_baseline * ENSEMBLE_WT_BASELINE))
seats_ensemble <- data.frame(seats_ensemble = apply(posterior_ensemble |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
seats_mrp <- data.frame(seats_mrp = apply(combined |> select(matches('X', ignore.case = F)),
MARGIN = 2, function(x) {sum(ifelse(x > 0, 1, 0))}) |>
as.vector())
data_post <- data.frame(seats_ensemble, seats_mrp) |>
pivot_longer(everything(), names_to = 'Model', values_to= 'Estimate') |>
mutate(model_str = case_when(
Model == 'seats_ensemble' ~ 'Ensemble',
Model == 'seats_mrp' ~ 'MRP'
))
plt_mrp <- ggplot(data = seats_mrp, aes(seats_mrp)) +
geom_histogram(
fill = "#1f78b4",
color = "black",
binwidth = 3) +
labs(x = 'Projected GOP House Seats\n (1000 Draws)', y = 'Frequency', title = 'MRP Model') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(140,150,160,170),
breaks =c(140,150,160,170) )
plt_ensemble <- ggplot(data = seats_ensemble, aes(seats_ensemble)) +
geom_histogram(
binwidth = 1,
fill = "#1f78b4",
color = "black") +
labs(x = 'Projected GOP House Seats\n (1000 Draws)', y = 'Frequency', title = 'Ensemble Model') +
theme_bw() +
theme(plot.title = element_text(size = 14, hjust = 0.5),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10)) +
scale_x_continuous(labels =c(188, 191, 194, 197, 200),
breaks  =c(188, 191, 194, 197, 200))
###Save to file
outfile <- paste0('figures/posterior_draws.png')
ggsave(outfile, plt_mrp | plt_ensemble, height = 7/2, width = 7)
